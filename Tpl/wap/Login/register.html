<!DOCTYPE html>
<html style="font-size: 50px;">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1.0,maximum-scale=1.0,minimum-scale=1,user-scalable=no">
    <meta content="yes" name="apple-mobile-web-app-capable">
    <meta content="black" name="apple-mobile-web-app-status-bar-style">
    <meta content="telephone=no" name="format-detection">
    <meta content="email=no" name="format-detection">
    <title>谐和生物会员注册</title>
    <link rel="stylesheet" href="__HOME__/iconfont/iconfont.css">
    <link rel="stylesheet" href="__HOME__/css/style.css">
    <style>
        .pay-input input {width: 13px;-webkit-appearance: radio;}
        .select-d{width: 221px;height: 33px;color: #fff;border-radius: 6px;border: 0;background: #463a86;padding-left: 10px;}
    </style>
</head>
<body class="mainbg loginbg">
<div class="maindiv">
    <form id="user_form" action="{:U('Login/register')}">
        <div class="titlediv" style="background-color: #2a38e9;z-index: 1;">
            <p><a href="{:U('Home/index')}"><i class="icon iconfont icon-fanhui"></i></a>谐和生物会员注册</p>
        </div>
        <div class="logoinput" style="margin-top: 0.2rem">
            <span><i class="icon iconfont icon-message" style="font-size: 0.4rem; margin-right: 0.18rem;"></i> 姓名：</span>
            <input type="text" name="username" value="uiuo" placeholder="请输入真实姓名">
        </div>
        <div class="logoinput" style="margin-top: 0.2rem">
            <span><i class="icon iconfont icon-message" style="font-size: 0.4rem; margin-right: 0.18rem;"></i> 身份证：</span>
            <input type="text" name="identity_card" value="2566554" placeholder="请输入身份证">
        </div>
        <div class="logoinput" style="margin-top: 0.25rem;">
            <span><i class="icon iconfont icon-shouji"></i> 手机号码：</span>
            <input type="text" name="mobile" maxlength="11" value="13566667" placeholder="请输入手机号码" notnull="">
        </div>
        <div class="logoinput" style="margin-top: 0.25rem;">
            <span><i class="icon iconfont icon-message" style="font-size: 0.4rem; margin-right: 0.18rem;"></i> 验证码：</span>
            <input type="text" placeholder="请输入验证码" value="1111" name="code" notnull="">
            <p class="ii-ispan sendmsgBtn" onclick="sendModile()">获取验证码</p>
        </div>
        <div class="logoinput" style="margin-top: 0.2rem">
            <span><i class="icon iconfont icon-message" style="font-size: 0.4rem; margin-right: 0.18rem;"></i> 微信号：</span>
            <input type="text" name="wx_no" value="15666677" placeholder="请输入微信号">
        </div>

        <div class="logoinput" style="margin-top: 0.2rem">
            <span><i class="icon iconfont icon-message" style="font-size: 0.4rem; margin-right: 0.18rem;"></i>选择级别 ：</span>
            <select class="select-d" name="product_id" id="product_id">
                <option value="-1" data-level="-1">请选择</option>
                <foreach name="productList" item="vo">
                    <option value="{$vo[id]}" data-level="{$vo['level']}">{$vo['level']|getUserLevelItems}（{$vo['activate_buy_num']}）盒</option>
                </foreach>
            </select>
        </div>

        <div class="logoinput" style="margin-top: 0.2rem">
            <span><i class="icon iconfont icon-message" style="font-size: 0.4rem; margin-right: 0.18rem;"></i>货运方式 ：</span>
            <select class="select-d" name="delivery_type" id="delivery_type">
                <option value="-1">未选择</option>
            </select>
        </div>

        <div style="display: none" class="addressInfo">
            <div class="logoinput" style="margin-top: 0.2rem">
                <span><i class="icon iconfont icon-message" style="font-size: 0.4rem; margin-right: 0.18rem;"></i> 收货人：</span>
                <input type="text" name="address[name]" value="" placeholder="请输入收货人">
            </div>
            <div class="logoinput" style="margin-top: 0.2rem">
                <span><i class="icon iconfont icon-message" style="font-size: 0.4rem; margin-right: 0.18rem;"></i> 收货手机号：</span>
                <input type="text" name="address[telephone]" value="" placeholder="请输入收货手机号">
            </div>
            <div class="logoinput" style="margin-top: 0.2rem">
                <span><i class="icon iconfont icon-message" style="font-size: 0.4rem; margin-right: 0.18rem;"></i>省：&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
                <select class="select-d" name="address[province_id]" id="province">
                    <option value="" selected="selected">--请选择省份--</option>
                </select>
            </div>
            <div class="logoinput" style="margin-top: 0.2rem">
                <span><i class="icon iconfont icon-message" style="font-size: 0.4rem; margin-right: 0.18rem;"></i>市：&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
                <select class="select-d" name="address[city_id]" id="city">
                    <option value="" selected="selected">--请选择市--</option>
                </select>
            </div>

            <div class="logoinput" style="margin-top: 0.2rem">
                <span><i class="icon iconfont icon-message" style="font-size: 0.4rem; margin-right: 0.18rem;"></i>区域：&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
                <select class="select-d" name="address[country_id]" id="district">
                    <option value="" selected="selected">--请选择区--</option>
                </select>
            </div>
            <div class="logoinput" style="margin-top: 0.2rem">
                <span><i class="icon iconfont icon-message" style="font-size: 0.4rem; margin-right: 0.18rem;"></i> 详细地址：</span>
                <input type="text" name="address[address]" value="" placeholder="请输入详细地址">
            </div>
        </div>

        <div class="logoinput" style="margin-top: 0.2rem">
            <span><i class="icon iconfont icon-message" style="font-size: 0.4rem; margin-right: 0.18rem;"></i> 推荐人：</span>
            <input type="text" readonly value="{$userInfo['mobile']}">
        </div>

        <div class="logoinput" style="margin-top: 0.25rem;">
            <span><i class="icon iconfont icon-mima" style="font-size: 0.4rem; margin-right: 0.18rem;"></i> 登录密码：</span>
            <input type="password" name="login_pwd" maxlength="25" value="111111" placeholder="请输入登陆密码" notnull="">
        </div>
        <div class="logoinput" style="margin-top: 0.25rem;">
            <span><i class="icon iconfont icon-mima" style="font-size: 0.4rem; margin-right: 0.18rem;"></i> 确认密码：</span>
            <input type="password" name="relogin_pwd" maxlength="25" value="111111" placeholder="请输入确认密码" notnull="">
        </div>
        <div class="logoinput" style="margin-top: 0.25rem;">
            <span><i class="icon iconfont icon-mima" style="font-size: 0.4rem; margin-right: 0.18rem;"></i> 交易密码：</span>
            <input type="password" name="safety_pwd" maxlength="25" value="111111" placeholder="请输入交易密码" notnull="">
        </div>

        <div class="loginbtn"><a href="javascript:void(0)" id="subbtn">立即注册</a></div>

    </form>
</div>
<script type="text/javascript" src="__HOME__/js/jquery-3.1.1.min.js"></script>
<script type="text/javascript" src="__HOME__/js/global.js"></script>
<script type="text/javascript" src="__HOME__/js/user4.js"></script>
<script type="text/javascript" src="__COM__/layer/layer.js"></script>
<script type="text/javascript" src="__COM__/js/index.js"></script>
<script type="text/javascript" src="__PUBLIC__/verify/address.js"></script>
<script>
    var deviceWidth = document.documentElement.clientWidth;
    document.documentElement.style.fontSize = deviceWidth / 7.5 + 'px';
    addressInit('province', 'city', 'district', '福建', '', '');//添加
</script>
<script>

    $('#product_id').change(function () {
       var level = $(this).find("option:selected").attr("data-level");
       var str = '';
       if(level == -1){
           str += ' <option value="-1">未选择</option>';
           $('.addressInfo').hide();
       }else if(level == 1){
           str += ' <option value="2">邮寄</option>';
           $('.addressInfo').show();
       }else {
           str += ' <option value="1">云库</option>';
           str += ' <option value="2">邮寄</option>';
           $('.addressInfo').hide();
       }
       $('#delivery_type').html(str);
    });

    $('#delivery_type').change(function () {
        var delivery_type = $(this).val();
        if(delivery_type == 2){
            $('.addressInfo').show();
        }else {
            $('.addressInfo').hide();
        }
    });


    //发送短信事件
    function sendModile() {
        var Phone = $('#user_form input[name=mobile]').val();
        if (!Phone.match(/^1[3-9]\d{9}$/)) {
            layer.msg('请填写正确的手机号码');
            $('#user_form input[name=mobile]').focus();
            return false;
        }

        $('.sendmsgBtn').html('获取验证码').attr('disabled', true);

        var time = 0;
        time_obj = function () {
            if (time >= 60) {
                $('.sendmsgBtn').html('获取验证码').attr('disabled', false);
                time = 0;
                clearInterval(timer);
            } else {
                $('.sendmsgBtn').html('重新(' + (60 - time) + ')');
                time++;
            }
        };
        var timer = setInterval('time_obj()', 1000);
        $.post("{:U('Login/sendCode')}", {'mobile': Phone}, function (data) {
            if (data.status == 1) {
                layer.msg(data.message);
                RemainTime();
            } else {
                layer.msg(data.message);
            }
        });
        $('.sendmsgBtn').attr('disabled', true);
    }

    //提交注册
    $('#subbtn').click(function () {
        var is_ajsx = $('#subbtn').hasClass('ajax_btn');
        if (is_ajsx) {
            layer.msg("请勿频繁操作");
            return false;
        }
        // $('#subbtn').addClass('ajax_btn');
        var post_url = $("#user_form").attr('action');
        var data = $("#user_form").serialize();
        doajax(post_url, data, function (data) {
            if (data.status == 1) {
                layer.alert(data.message, {
                    time: 0 //不自动关闭
                    , btn: ['好']
                    , yes: function (index) {
                        layer.close(index);
                        window.location.href = data.url;
                    }
                    , cancel: function (index) {
                        window.location.href = data.url;
                    }
                });
            } else {
                layer.msg(data.message);
                if(data.url){
                    setTimeout(function () {
                        window.location.href = data.url;
                    },500)
                }
            }
            $('#subbtn').removeClass('ajax_btn');
        });
    });

</script>
</body>
</html>